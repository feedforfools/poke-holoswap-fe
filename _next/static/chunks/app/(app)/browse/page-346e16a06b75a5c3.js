(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[566],{1290:(e,a,s)=>{Promise.resolve().then(s.bind(s,4080))},4080:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>f});var t=s(5155),l=s(2115),c=s(5695),o=s(2127),n=s(2303),r=s(3329),u=s(3087),i=s(8856),d=s(9218),g=s(1950);function m(){return(0,t.jsxs)("div",{className:"flex flex-1 flex-col h-full",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row h-auto md:h-16 shrink-0 items-center justify-between gap-3 border-b bg-background px-4 py-2 md:py-0 sticky top-0 z-10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 w-full md:w-auto self-start md:self-center",children:[(0,t.jsx)(d.x2,{className:"-ml-1 md:hidden"}),(0,t.jsx)(i.E,{className:"h-6 w-32 ml-2 md:ml-0"})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-3 w-full md:w-auto",children:[(0,t.jsx)(i.E,{className:"h-9 w-full sm:w-[180px]"})," ",(0,t.jsx)(i.E,{className:"h-9 w-full sm:w-[180px]"})," ",(0,t.jsx)(i.E,{className:"h-9 w-full sm:w-auto flex-1 md:w-[200px] lg:w-auto"})," "]})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-10 gap-4",children:Array.from({length:g.t}).map((e,a)=>(0,t.jsx)("div",{className:"flex flex-col space-y-2",children:(0,t.jsx)(i.E,{className:"aspect-[2.5/3.5] w-full max-w-48 mx-auto"})},"skeleton-browse-".concat(a)))})})]})}function h(){var e,a,s,i;let d=(0,c.useRouter)(),m=(0,c.usePathname)(),h=(0,c.useSearchParams)(),[f,x]=(0,l.useTransition)(),p=null!=(e=null==h?void 0:h.get("q"))?e:"",S=null!=(a=null==h?void 0:h.get("set"))?a:"all",w=null!=(s=null==h?void 0:h.get("sort"))?s:"-releaseDate",v=parseInt(null!=(i=null==h?void 0:h.get("page"))?i:"1",10),[j,b]=(0,l.useState)([]),[N,k]=(0,l.useState)(!0),[P,C]=(0,l.useState)(null),[y,E]=(0,l.useState)(0),[O,R]=(0,l.useState)(g.t),{availableSets:_,isLoadingSets:L,setFetchError:U}=(0,r.m)(),q=(0,l.useRef)(!0),z=(0,l.useCallback)(async(e,a,s,t)=>{console.log("Callback: loadCards - Page: ".concat(e,", Search: '").concat(a,"', Set: ").concat(s,", Sort: ").concat(t)),k(!0),C(null);try{let l=[];a.trim()&&l.push('name:"'.concat(a.trim(),'*"')),s&&"all"!==s&&l.push("set.id:".concat(s));let c=l.join(" ")||void 0,n=await (0,o.ul)(e,c,t||void 0);b(n.data),R(n.pageSize||g.t),E(n.totalCount)}catch(e){console.error("Failed to load cards:",e),C(e instanceof Error?e.message:"Unknown error fetching cards"),b([]),E(0)}finally{k(!1),console.log("Finished loading cards.")}},[]);(0,l.useEffect)(()=>{console.log("Effect: loadCards - Page: ".concat(v,", Search: '").concat(p,"', Set: ").concat(S,", Sort: ").concat(w)),z(v,p,S,w),q.current&&(q.current=!1)},[v,p,S,w,z]);let F=e=>{let a=new URLSearchParams(null==h?void 0:h.toString());Object.entries(e).forEach(e=>{let[s,t]=e;null===t||""===t||"set"===s&&"all"===t?a.delete(s):a.set(s,t)}),void 0!==e.q||void 0!==e.set||void 0!==e.sort||!a.has("page")&&Object.keys(e).includes("page")&&"1"===e.page?a.set("page","1"):"1"===a.get("page")&&Object.keys(e).includes("page")&&a.delete("page");let s=void 0!==e.page&&1===Object.keys(e).length,t=s?d.push:d.replace,l=s?{scroll:!0}:{scroll:!1};x(()=>{console.log("Updating URL:","".concat(m,"?").concat(a.toString())),t("".concat(m,"?").concat(a.toString()),l)})};return(0,t.jsx)(n.G,{title:"Browse Cards",cards:j,isLoading:N,error:P,totalCount:y,currentPage:v,pageSize:O,onPageChange:e=>F({page:String(e)}),searchValue:p,onSearchChange:e=>{},onDebouncedSearchChange:e=>{e!==p&&F({q:e})},selectedSet:S,onSetChange:e=>F({set:e}),selectedSort:w,onSortChange:e=>F({sort:e}),availableSets:_,isLoadingSets:L,setFetchError:U,sortOptions:u.VB,isPending:f})}function f(){return(0,t.jsx)(l.Suspense,{fallback:(0,t.jsx)(m,{}),children:(0,t.jsx)(h,{})})}},5695:(e,a,s)=>{"use strict";var t=s(8999);s.o(t,"usePathname")&&s.d(a,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(a,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(a,{useSearchParams:function(){return t.useSearchParams}})}},e=>{var a=a=>e(e.s=a);e.O(0,[948,569,951,962,441,684,358],()=>a(1290)),_N_E=e.O()}]);